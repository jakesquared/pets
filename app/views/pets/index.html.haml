#doggy-bag
  .doggy-bag-content
    .options
      .close
      .reset
    .items
      %h1
        You haven't added any buddies yet.
.search-bar
  %h1 Dogs in San Francisco, CA
  =form_tag pets_path, :method => :get do
    =text_field_tag('zip',nil, :placeholder => 'Enter your zip code')
    =submit_tag('Change location')
  .drop-zone.droppable
.hero-section
  .content
    .show-doggy-bag
    .logo
    %h1.main-heading
      Scruffy
      &nbsp;&nbsp;
      %span.cat-icon
      Buddy
    .form
      =form_tag pets_path, :method => :get do
        =text_field_tag('zip',nil, :placeholder => 'Enter your zip code')
        =submit_tag('Find A Pal')
#options.wrapper.clearfix
  .options
    %ul.clearfix
      %li#cat
        I
        %span.heart
        Cats
      %li#dog
        I
        %span.heart
        Dogs
-if @pets.empty?
  -@locations.each do |location|
    %a{:href => "?zip=#{location.zip}"}
      = "#{location.city}, #{location.state}"
-else
#pets.wrapper.clearfix
  - @pets.each do |pet|
    -if pet.photo?
      %div{:class => "container pet draggable #{pet.species}"}
        .card
          .face.front
            .filter
            .image-cropper
              = image_tag(pet.photo)
            %p
              = pet.name
          .face.back
            .content
              .thumb
                = image_tag(pet.photo)
              .favicon
              %p.desc
                = truncate(strip_tags(pet.description), :length => 150)
:javascript
  $(function(){
    if(!($.browser.webkit)){
      window.location = "http://img42.imageshack.us/img42/561/218catplayingelectricgu.gif";
    };

    $.each($('.pet'), function(){
      var amount = randomFromTo(-10, 10);
      $(this).css({'-webkit-transform':'rotate('+amount+'deg)'});
    })
    function randomFromTo(from, to){
       return Math.floor(Math.random() * (to - from + 1) + from);
    }

    $(window).scroll(function(){
     if($(window).scrollTop() > 300){
      $('.search-bar').fadeIn('fast');
     }else{
      $('.search-bar').fadeOut('fast');
     }
    });

    $('.options li').click(function(){
      var sibling = $(this).siblings('li').addClass('strike');
      $(this).removeClass('strike');
      var hide = sibling.attr('id');
      $('#pets .' + hide).addClass('hidden');
      $('#pets .' + $(this).attr('id')).removeClass('hidden');
    });

    $('.drop-zone, .show-doggy-bag').click(function(){
        $('#doggy-bag').animate({'top' : '0px'}, 300);
      }
    );
    $('#doggy-bag .close').click(function(){
      $('#doggy-bag').animate({'top' : '-400px'}, 300);
    });
    $('#doggy-bag .reset').click(function(){
      $('#doggy-bag .pet').remove();
      $('.items h1').removeClass('hidden');
    });

    $( ".draggable" ).draggable({
      revert: 'invalid',
      scroll: false
    });
    $( ".droppable" ).droppable({
        tolerance: 'touch',
        over: function(event, ui){
          $('.drop-zone').toggleClass('hovered');
          if($('#doggy-bag .items').children().length < 3){
            ui.draggable.toggleClass('semi-transparent');
          }
        },
        drop: function( event, ui ) {
          if(!($('.items h1').hasClass('hidden'))){
           $('.items h1').addClass('hidden');
          }
          $('.drop-zone').toggleClass('hovered');
          if($('#doggy-bag .items').children().length !== 4){
            $(ui.draggable).attr('style', '').removeClass('semi-transparent');
            $('#doggy-bag .items').append(ui.draggable);
          }
          else{
            $( '.draggable' ).draggable( "option", "revert", true );
          }
        }
    });

    $('.favicon').click(function(){
      if(!($('.items h1').hasClass('hidden'))){
       $('.items h1').addClass('hidden');
      }
      var pet = $(this).closest('.pet');
      console.log(pet);
      if(($('#doggy-bag .items').children().length !== 4) && (!$(this).hasClass('faved'))){
        $(this).addClass('faved');
        pet.clone().appendTo('#doggy-bag .items');
      }
    });



  });//en dom ready